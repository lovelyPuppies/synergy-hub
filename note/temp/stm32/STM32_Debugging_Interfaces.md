# Debugging Interfaces and USART2 in STM32F411

STM32F411 provides multiple debugging and communication options, such as **SWD**, **SWO**, and **USART2**. Here's a concise explanation of each and how they relate to debugging.

---

## 1. SWD (Single Wire Debug)
- **Purpose**: A protocol for debugging microcontrollers.
- **Pins**:
  - **TMS (PA13)**: Known as SWDIO in SWD mode, it is used for bidirectional data communication during debugging.
  - **TCK (PA14)**: Known as SWCLK in SWD mode, it provides the clock signal for SWD communication.
- **Usage**:
  - Allows firmware uploads and debugging (e.g., breakpoints, step-through execution).
  - Requires a debugger tool like **ST-LINK**.
- **Key Point**: SWD is a replacement for the more complex JTAG protocol, requiring fewer pins.

---

## 2. SWO (Serial Wire Output)
- **Purpose**: A feature of the SWD protocol used for debug logging and tracing.
- **Pin**:
  - **SWO (PB3)**: Outputs debug or trace messages generated by the **ITM (Instrumentation Trace Macrocell)**.
- **Usage**:
  - Used for real-time logging and diagnostic output from the microcontroller during debugging.
  - Works with ST-LINK or other SWD-compatible debuggers.
- **Key Point**: SWO can output `printf`-like messages if properly configured in STM32CubeIDE or other debugging software.

---

## 3. USART2 (‚ùì for only current board settings)
- **Purpose**: A general-purpose UART communication protocol, often used for debugging when connected to a terminal (like Tera Term or PuTTY) on a PC.
- **Pins**:
  - **USART2_TX (PA2)**: Transmits data from the STM32 to an external device (e.g., PC).
  - **USART2_RX (PA3)**: Receives data from an external device (not used in the provided code).
- **Usage**:
  - In this code, **USART2_TX (PA2)** is configured to transmit debug messages via `printf`.
  - The implementation uses:
    ```c
    HAL_UART_Transmit(&huart2, (uint8_t *)&ch, 1, 0xFFFF);
    ```
    to route `printf` data through UART, allowing you to view it on a PC terminal.
- **Key Point**: Unlike SWO, which requires SWD tools, USART2 works directly with UART-to-USB adapters for debugging.

---

## 4. Key Differences Between SWD/SWO and USART2

| Feature         | **SWD (TMS, TCK)**      | **SWO (PB3)**          | **USART2 (PA2, PA3)**          |
|------------------|-------------------------|-------------------------|--------------------------------|
| **Purpose**      | Debugging protocol      | Real-time debug output  | Debugging or communication    |
| **Output Method**| ST-LINK Debugger        | ST-LINK Debugger        | UART Serial Terminal (PC)     |
| **Pin Count**    | 2 pins (TMS, TCK)       | 1 pin (PB3)             | 2 pins (PA2, PA3)             |
| **Data Type**    | Debug control signals   | Log/trace data          | Debug messages (e.g., `printf`) |
| **Hardware Needs** | ST-LINK or similar tool | ST-LINK or similar tool | UART-to-USB adapter (optional) |

---

## 5. Debugging in the Provided Code
- **USART2 for Debugging**:
  - The `printf` function is routed through `HAL_UART_Transmit()` to the **USART2_TX (PA2)** pin.
  - Debugging output (e.g., distance readings) is transmitted and can be viewed on a PC via a UART terminal.
- **SWD (TMS, TCK)**:
  - Used only for uploading the firmware and debugging via tools like ST-LINK.
- **SWO (PB3)**:
  - Not used in the provided code. If enabled, it could output debug logs via the ITM.

---

## 6. Summary of Each Debugging Option
1. **SWD**:
   - Debug protocol for STM32, used for firmware upload and debugging (e.g., setting breakpoints).
   - Requires TMS (PA13) and TCK (PA14).

2. **SWO**:
   - Used for advanced real-time debug logs, but not utilized in the provided code.
   - Requires PB3.

3. **USART2**:
   - Directly outputs `printf` debug messages to a PC terminal.
   - Requires PA2 (USART2_TX) for message transmission.

---

## Which Option to Use?
- Use **SWD** for debugging the code and uploading firmware.
- Use **USART2** if you need `printf` output in a serial terminal for debugging.
- Use **SWO** if advanced trace and profiling features are required.

Let me know if you'd like further clarification!
